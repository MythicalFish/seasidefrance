---
import { marked } from 'marked';
import AvailablePeriods from './AvailablePeriods';
import FeatureList from './FeatureList';
import PropertyPhotos from './PropertyPhotos.astro';
import PropertyIntro from './PropertyIntro.astro';
const { property, expanded = false, linked = false } = Astro.props;
const lodgify = property?.lodgify;
const descriptionHtml = property.description ? marked.parse(property.description) : '';
const photoLayout = expanded ? 'gallery' : 'single';
---

<div class="p-6">
  {
    linked ? (
      <a href={`/${property.slug}`}>
        <PropertyPhotos property={property} layout="single" />
        <PropertyIntro property={property} />
      </a>
    ) : (
      <>
        <PropertyPhotos property={property} layout={photoLayout} />
        <PropertyIntro property={property} />
      </>
    )
  }
  <AvailablePeriods
    client:load
    useSwiper
    propertyId={property.id}
    rates={property.rates}
    availability={property.availability}
    currencyCode={lodgify.currencyCode}
    limit={8}
  />
  {
    expanded && (
      <>
        <div class="mt-4" set:html={descriptionHtml} />
        <FeatureList title="Features" items={property.features} />
        <FeatureList title="Highlights" items={property.highlights} />
      </>
    )
  }
</div>
